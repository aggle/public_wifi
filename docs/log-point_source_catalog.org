#+TITLE: Point Source Catalog notes

I realized that I need a place to compile all the things to do for the point source catalog, rather than have them scattered in different daily logs.



* Some notes from previous, where I left off ([[file:~/Documents/org-notes/2020-05-21.org][original file here]]) 
  OK, I started plotting fit quality against various thresholds. Figures are folded into the update for the tag-up next week (prob May 28). It looks like a cutoff of q=0.9 only leaves 75% of the stars in the dataset. The question is what magnitude and mass does that correspond to?
  Some more diagnostics to look at (which are noted in the notebook KS2_inspector.ipynb:
  1. [X] Plot the distribution of q from the master catalog (not the NIMFO)
  2. [ ] Plot the scatter in q as a function of q (or z, the counts)
  3. [ ] Plot the cumulative distribution of q (really, what I want to know is how many I *lose* below a certain cutoff
  4. [ ] Plot q as a function of z
  5. [ ] Look at how the number of stars in each z bin changes as you cut on q; because this will affect how faint you can go

  Left off: on the q CDF plot, I'm in the middle of adding a right axis that shows the absolute number, not the CDF. Then the horizontal lines should go all the way across.
  NOOOOO THE CDF PLOT IS ALL WRONG BECAUSE I HAVE TO DO THE CUMSUM OF THE HISTOGRAM BINS, NOT THE VALUES

* How to begin:
  I have a list of point sources detected in each exposure, the primary star ID number, and positions in both the individual exposures and master frames. However, the data need cleaning, because some stars were not detected in all the exposures they should have been detected in, some PSFs have very poor fits, or other problems I haven't thought to list here. 
  I think the first step is to get a feel for how many stars (or point sources) we lose by cutting on various thresholds of PSF fit quality. I was on the right track before, so let's start ticking off boxes:

** q distributions
  1. [X] Plot the distribution of q from the master catalog (not the NIMFO)
     #+NAME:  fig:q-distro
     #+CAPTION: The distribution of PSF fit quality
     [[/user/jaguilar/tr14/code/figs/ks2/q-distro.png]]
  2. [X] Plot the cumulative distribution of q (really, what I want to know is how many I *lose* below a certain cutoff
     #+NAME:  fig:q-distro-cumulative
     #+CAPTION: The distribution of PSF fit quality
     [[/user/jaguilar/tr14/code/figs/ks2/q-distro_cumulative.png]]
  3. [ ] Plot the scatter in q as a function of q (or z, the counts)
  4. [X] Plot q as a function of z
     #+NAME:  fig:z_vs_q
     #+CAPTION: q plotted against log of the flux, with the different q thresholds marked by horizontal lines.
    [[/user/jaguilar/tr14/code/figs/ks2/z_vs_q.png]]
  5. [ ] Look at how the number of stars in each z bin changes as you cut on q; because this will affect how faint you can go
  
  I'll consider cuts to /q/ at the following thresholds: 0.7, 0.8, 0.85, 0.9, 0.95

  Some of the stars that have q=0 in the master dataframe are bad detections, but also some of them are fine - they just get flagged q=0 because they don't appear in one of the filters (so the q for that filter gets set to 0). I think the lesson here is that I should filter for q (and z, and probably others) on the *point source dataframe*, and not the *master dataframe*.
